function MultipleChoiceAdapter(){}function getSummaryAudio(){return dataObject.directionAudio}function loadPageData(a,b,c){function d(d){var e=CollectionUtils.findElementWithProperty("url",a,d.fileContents).data,f=CollectionUtils.findElementWithProperty("url",b,d.fileContents).data,g=Configuration.parseXML(CollectionUtils.findElementWithProperty("url",c,d.fileContents).data);dataObject=MultipleChoiceAdapter.parseXML(e,f,g),populateContent(dataObject)}var e=new BatchLoader;$(e).bind(BatchLoader.LOAD_COMPLETE,d),e.loadFiles([a,b,c])}function populateContent(a){function b(){function b(){return.5-Math.random()}for(var c=[],d=[],e=0;e<a.options.length;e++)a.options[e].fixed&&"false"==a.options[e].fixed&&d.push(a.options[e]);d.sort(b);for(var e=0,f=0;e<a.options.length;e++)a.options[e].fixed&&"false"==a.options[e].fixed?(c.push(d[f]),f++):c.push(a.options[e]);return c}$("#operationsContainer button").button(),$("#ShowMe").click(onBtnShowMeClick),$("#btnSubmit").click(onBtnSubmitClick),$("#resetBtn").click(resetTemplatState),$("#attemptagain").click(resetTemplatState),$("#btnSubmit").button("disable"),disableButton("#btnSubmit"),disableButton("#resetBtn"),disableButton("#attemptagain"),$("#header").html(a.header),$("#header").attr("tabindex",previewTabIndexStart++),renderDirectionAudioText(),renderDirectionAudio(),$("#pageContainer #introduction").html(a.introduction),$("#pageContainer #introduction").attr("tabindex",previewTabIndexStart++),$("#pageContainer #question").html(a.direction.text),$("#pageContainer #question").attr("tabindex",previewTabIndexStart++),$("#pageContainer #instruction").html(a.instruction),$("#pageContainer #instruction").attr("tabindex",previewTabIndexStart++),$("#pageContainer #optionsContainer #optionsWrapper").empty(),MAX_TRIES_PER_CARD=a.IS_ATTEMPT_AGAIN?1/0:a.maximumtries?a.maximumtries:3;var c=b();if($(c).each(function(){function b(a){a.getTip().css("visibility","hidden"),a.getTip().focus();{var b=$("#pageContainer").css("width"),d=parseInt(b)-40,e=($("#dropBucketsContainer").css("width"),d-a.getTip().offset().left),f=parseInt($("#pageContainer").css("height")),g=parseInt(a.getTip().css("height"));a.getTip().offset().top+g,parseInt($("#currentPageContainer").css("height"))}if(a.getTip().offset().top<0&&a.getTip().css("top",15),a.getTip().offset().top+g>f-30&&(a.getTip().css("width",e),g=parseInt(a.getTip().css("height")),a.getTip().offset().top+g>f-30)){var h=a.getTip().offset().top+g-f;a.getTip().css("top",a.getTip().offset().top-(h+30))}$(document).bind("DOMMouseScroll mousewheel touchstart",{context:a},c),$(window).bind("resize",{context:a},c),a.getTip().css("visibility","visible")}function c(a){var b=a.data.context,c=b.getTrigger().data("tooltip");c.hide()}var d="";if(this.text){d=$('<div data-id="Option '+(this.originalIndex+1)+'" class="choiceOption custom-radio commentable"></div>');var e=$('<input tabindex="'+previewTabIndexStart++ +'" type="radio" name="options" value="'+this.identifier+'" id="option_'+this.identifier+'" />');$(d).append(e);var f=$('<div id="'+this.identifier+'" class="wrapper"></div>');$(d).append(f);var g=$('<label for="option_'+this.identifier+'"><div class="labelTextWrapper">'+this.text+"</div></label>");$(f).append(g);var h=$('<div class="answerIndicatorContainer"></div>'),i=null;if(i=$(a.correctOption&&this.identifier==a.correctOption.identifier?'<a class="correctIndicator answerIndicator">Correct</a>':'<a class="incorrectIndicator answerIndicator">Incorrect</a>'),$(i).attr("id",this.identifier+"AnswerIndicator"),$(i).hide(),$(h).append(i),this.attemptFeedback){var j=$('<div class="attemptFeedback feedbackTip">'+this.attemptFeedback+"</div>");$("body").append(j),$(j).attr("id",this.identifier+"AttemptFeedback"),$(j).hide(),$(i).enterEnabled(),$(i).bind("click enter",function(a){a.stopPropagation()}),$(i).tooltip({tip:"#"+$(j).attr("id"),position:"top right",events:{def:"click enter, mousedownoutside keypressoutside",tooltip:"mouseover touchstart, mouseleave touchend blur enter"},onShow:function(){b(this)},onBeforeHide:function(){this.getTrigger().focus(),$(document).unbind("DOMMouseScroll mousewheel touchstart",c),$(window).unbind("resize",c)}}).dynamic()}$(g).find(".labelTextWrapper").append(h),$(d).bind("change",onOptionSelectionChange),$(d).keydown(onkeydownOptions),$("#optionsWrapper").append(d)}}),a.direction.media&&a.direction.media.hasMedia){$("#imageContainer").empty();var d=a.direction.media,e=mediaImage.createElement(d);if($(e).attr("id","imageContainer"),$("#imageContainer").replaceWith(e),$(e).addClass("commentable"),$(e).attr("data-id","Associated Image"),previewTabIndexStart=mediaImage.setTabIndices(e,previewTabIndexStart),!ClientInformation.isMobileDevice()&&a.rolloverCaption&&($(e).find(".caption").css("display","none"),d.caption)){var f=d.caption;$(e).find("img").attr("title",$(f).text())}}else $("#imageContainer").remove(),$("#optionsContainer").css("margin-right","0");$("#btnSubmit").attr("tabindex",previewTabIndexStart++),$("#ShowMe").attr("tabindex",previewTabIndexStart++),enableButton("#ShowMe"),a.hintInformation?hintComponentSetter(a.hintInformation):$("#hintContainer").remove(),a.exampleInformation?exampleComponentSetter(a.exampleInformation):$("#example-info, #exampleContainer").remove(),sendPostData("setAudio"),ThemeConfig.currentTheme==ThemeVariation.AQUA&&("undefined"==typeof widgetSettings&&$("#operationsContainer").hide(),sendPostData("isShowMePrsnt"),sendPostData("isAttemptAgainPrsnt"),sendPostData("isResetPrsnt"),dispatchHeaderData());var g=jQuery.Event(PageDataHandler.DATA_LOADED);$(document).trigger(g),ClientInformation.isMobileDevice()||$($("body").find("*[tabindex]")).get(0).focus(),Modernizr.boxshadow||(addSupportForArtificialOuterShadow($("#imageContainer")),$("button").addClass("styledWithFallback")),themeBehavior();var h=$("#ShowMe"),i=$("#resetBtn"),j=$("#attemptagain");$("#btnSubmit").show(),hideButtons(h,j,i),renderTimer()}function onOptionSelectionChange(){$("#btnSubmit").button("enable"),enableButton("#btnSubmit"),$("#resetBtn").button("enable"),enableButton("#resetBtn")}function onkeydownOptions(a){switch(a.which){case 40:case 38:case 37:case 39:$("#btnSubmit").button("enable"),enableButton("#btnSubmit")}}function onBtnSubmitClick(){dataObject.IS_ATTEMPT_AGAIN&&sendPostData("stoptimer"),$("#attemptagain").button("enable"),enableButton("#attemptagain"),$("#resetBtn").button("disable"),disableButton("#resetBtn"),numberOfTries++,$("#btnSubmit").button("disable"),disableButton("#btnSubmit");var a=jQuery.Event("feedback");a.direction=dataObject.direction;var b=$("'input[name='options']:checked").val();a.selectedOption=b,a.answer=null,$(dataObject.options).each(function(){return this.identifier==b?(a.answer=this,!1):void 0}),a.correctAnswer=dataObject.correctOption,a.isCorrectAnswer=!1,dataObject.correctOption&&(b==dataObject.correctOption.identifier?(a.isCorrectAnswer=!0,correctTry="correct"):a.isCorrectAnswer=!1);var c={};a.isCorrectAnswer?(c.dfeedback=$("#correct").html(),c.globalfeedback=dataObject.globalFeedback.correctFeedback):numberOfTries==MAX_TRIES_PER_CARD?(c.dfeedback=$("#incorrect").html(),c.globalfeedback=dataObject.globalFeedback.incorrectFeedback):c.dfeedback=$("#incorrect_once").html(),(numberOfTries>=MAX_TRIES_PER_CARD||dataObject.IS_ATTEMPT_AGAIN)&&($("#btnSubmit").button("disable"),disableButton("#btnSubmit"),disableOptions(),$(".answerIndicator").hide(),$("#"+b+"AnswerIndicator").css("display",""),a.isCorrectAnswer||(c.globalfeedback=dataObject.globalFeedback.incorrectFeedback)),"correct"==correctTry?(setAssessmentScore(1),$(".answerIndicator").hide(),$("#"+b+"AnswerIndicator").css("display",""),$("#btnSubmit").button("disable"),disableButton("#btnSubmit"),disableOptions()):setAssessmentScore(0),a.feedback=c,$(document).trigger(a)}function disableOptions(){$("input[name='options']").each(function(){$(this).attr("disabled","disabled"),$(this).attr("tabindex")&&($(this).parent().find("label").attr("previewTabIndexStart",$(this).attr("tabindex")),$(this).removeAttr("tabindex"))}),$("label").css("cursor","default")}function onBtnShowMeClick(){var a=previewTabIndexStart;if($(".answerIndicator").hide(),dataObject.correctOption){$("label").removeClass("checked");var b=$.trim(dataObject.correctOption.identifier);$("input[value='"+b+"']").attr("checked","checked"),$("#"+b+"AnswerIndicator").css("display",""),$("label[for=option_"+b+"]").addClass("afterchecked")}$("#btnSubmit").button("disable"),disableButton("#btnSubmit"),disableButton("#ShowMe"),disableButton("#attemptagain"),disableOptions();var c=!1;dataObject.globalFeedback&&dataObject.globalFeedback.correctFeedback&&(c=!0,$("#feedbackContainer").removeClass("hidden"),$("#feedbackContainer #feedbackText").hide(),$("#feedbackContainer #feedbackText").removeAttr("tabindex"),$("#feedbackContainer #diagnosticText").show(),$("#feedbackContainer #diagnosticText").html(dataObject.globalFeedback.correctFeedback),$("#feedbackContainer #diagnosticText").children().attr("tabindex",a++)),c&&$.colorbox($.extend({},colorBoxConfiguration,{href:"#feedbackContainer",onComplete:function(){onModalComplete()},onCleanup:onModalCleanUp,onClosed:function(){onModalClose(),enableButton("#ShowMe"),enableButton("#attemptagain"),$("#feedbackContainer").addClass("hidden"),$("#ShowMe").focus()}})),ThemeConfig.currentTheme==ThemeVariation.AQUA?($("#btnSubmit").button("disable"),disableButton("#btnSubmit"),$("#resetBtn").button("enable"),disableButton("#resetBtn")):($("#btnSubmit").button("disable"),disableButton("#btnSubmit"),$("#resetBtn").button("disable"),disableButton("#resetBtn"))}function freezeactivity(){disableOptions(),$("#btnSubmit").button("disable"),$("#ShowMe").button("disable"),$("#resetBtn").button("disable"),$("#attemptagain").button("disable"),disableButton("#ShowMe"),disableButton("#resetBtn"),disableButton("#btnSubmit"),disableButton("#attemptagain")}function provideFeedback(a){var b=previewTabIndexStart;$("#feedbackContainer").removeClass("hidden"),a.feedback.dfeedback?($("#feedbackContainer #feedbackText").show(),$("#feedbackContainer #feedbackText").html(a.feedback.dfeedback),$("#feedbackContainer #feedbackText").attr("tabindex",b++)):$("#feedbackContainer #feedbackText").hide(),a.feedback.globalfeedback?($("#feedbackContainer #diagnosticText").show(),$("#feedbackContainer #diagnosticText").html(a.feedback.globalfeedback),$("#feedbackContainer #diagnosticText").children().attr("tabindex",b++)):$("#feedbackContainer #diagnosticText").hide(),$("#cboxClose a").bind("enter",function(){$(this).click()}),$("#cboxClose a").enterEnabled(),disableButton("#ShowMe"),$.colorbox($.extend({},colorBoxConfiguration,{href:"#feedbackContainer",onComplete:function(){onModalComplete()},onCleanup:onModalCleanUp,onClosed:function(){onModalClose(),enableButton("#ShowMe"),numberOfTries>=MAX_TRIES_PER_CARD||"correct"!=correctTry&&($("input:radio").attr("checked",!1),$(".choiceOption").find("label").removeClass("checked"),$(".choiceOption").find("label").removeClass("afterchecked")),$("#feedbackContainer").addClass("hidden"),$("#ShowMe").focus()}}))}function refreshPage(){var a=jQuery.Event("refresh");$(window).trigger(a)}function renderPrintDocument(){return MCPrintAdapter.renderPrintDocument(dataObject)}function changeToAssessmentMode(){isInAssessmentMode=!0,$("#ShowMe").remove()}function getAssessmentScore(){return isInAssessmentMode?assessmentItemScore:0}function setAssessmentScore(a){isInAssessmentMode&&!isAssessmentItemScoreDirty&&(assessmentItemScore=a)}function themeBehavior(){!window.ThemeConfig||ThemeConfig.currentTheme!=ThemeVariation.AQUA&&ThemeConfig.currentTheme!=ThemeVariation.PURE_GREEN&&ThemeConfig.currentTheme!=ThemeVariation.ORANGEADE||$("input").customInput()}function resetTemplatState(){$(".choiceOption").find("label").removeClass("checked"),$(".choiceOption").find("label").removeClass("afterchecked"),$('input[type="radio"]').attr({checked:!1,disabled:!1}),$(".answerIndicator").css("display","none"),$("#btnSubmit").button("option","disabled",!0),$("label").css("cursor","pointer"),$("#resetBtn").button("disable"),disableButton("#resetBtn"),$("#btnSubmit").button("disable"),disableButton("#btnSubmit"),$("#attemptagain").button("disable"),disableButton("#attemptagain")}function checkSubmitAnswer(){$(".feedbackTip").hide(),onBtnSubmitClick()}function showmeAnswer(){$(".feedbackTip").hide(),onBtnShowMeClick()}function resetAnswer(){$(".feedbackTip").hide(),resetTemplatState()}function attemptAgain(){$(".feedbackTip").hide(),resetAnswer(),sendPostData("stoptimer"),sendPostData("starttimer")}MultipleChoiceAdapter.parseXML=function(a,b,c){var d={},e=AssetUtils.prepareAssetReferenceMap(b);for(var f in e)e[f]=c.assetLocation+e[f];var g=$(a).find("itemBody");$(g).attr("id")&&(window.pageId=$.trim($(g).attr("id"))),d.header=AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(a).find("itemBody > div[id='header'] p").text()),e),d.direction={},d.direction.text=AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(a).find("itemBody > div[id='direction']").children("p").text()),e),$(a).find("itemBody > div[id='direction'] > div[class*='media']").size()&&(d.direction.media=MediaElementAdapter.parseXML($(a).find("itemBody > div[id='direction'] > div[class*='media']"),e)),d.instruction=AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(a).find("itemBody > div[id='instruction'] p").text()),e),d.introduction=AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(a).find("itemBody > div[id='introduction'] p").text()),e);var h=$(a).find("responseDeclaration > correctResponse > value").text();$(a).find("itemBody > div[id='SETTINGS']> div[id='IS_CAPTION']").size()&&$(a).find("itemBody > div[id='SETTINGS']> div[id='IS_CAPTION']").text()&&(d.rolloverCaption="true"==$(a).find("itemBody > div[id='SETTINGS']> div[id='IS_CAPTION']").text()?!0:!1),d.options=[];var i=$(a).find("itemBody > choiceInteraction > simpleChoice");$(a).find("itemBody > div[id='SETTINGS'] > div[id='MAX_TRIES']").size()&&$(a).find("itemBody > div[id='SETTINGS'] > div[id='MAX_TRIES']").text()&&(d.maximumtries=$(a).find("itemBody > div[id='SETTINGS'] > div[id='MAX_TRIES']").text()),$(a).find("itemBody > div[id='SETTINGS']> div[id='TIME_OUT']").size()&&(d.activitytime=$(a).find("itemBody > div[id='SETTINGS'] > div[id='TIME_OUT']").text()),d.settingsversion=$(a).find("itemBody > div[id='SETTINGS']").attr("class"),$(i).each(function(b){var c={};c.identifier=$(this).attr("identifier"),c.fixed=$(this).attr("fixed"),c.originalIndex=b,c.text=AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(this).find("p").text()).replace("<br />",""),e),c.attemptFeedback=$(this).find("feedbackInline").size()?AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(this).find("feedbackInline").text()),e):AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(a).find("assessmentItem > outcomeDeclaration > modalFeedback").find("p").text()),e),$.trim(c.text)&&d.options.push(c),h==c.identifier&&(d.correctOption=c)}),d.globalFeedback={};var j=$(a).find("assessmentItem > outcomeDeclaration > modalFeedback");return d.globalFeedback.correctFeedback=AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(j).find("p").text()),e),d.globalFeedback.incorrectFeedback=AssetUtils.replaceAssetIDwithURLs(TLFToHTMLAdapter.convertToHTMLString($(j).find("p").text()),e),$(a).find('itemBody > div[id="directionAudio"]').size()&&$(a).find('itemBody > div[id="directionAudio"] object').size()&&$(a).find('itemBody > div[id="directionAudio"] object').attr("data")&&(d.directionAudio=MediaElementAdapter.parseXML($(a).find('itemBody > div[id="directionAudio"]'),e)),$(a).find('itemBody > div[id="hint"]').size()&&$(a).find('itemBody > div[id="hint"] > p').text()&&(d.hintInformation=HintAdapter.parseXML($(a).find('itemBody > div[id="hint"]'),e)),$(a).find('itemBody > div[id="example"]').size()&&($(a).find('itemBody > div[id="example"] > p').text()||$(a).find('itemBody > div[id="example"] img').size())&&(d.exampleInformation=ExampleAdapter.parseXML($(a).find('itemBody > div[id="example"]'),e)),$(a).find("itemBody > div[id='SETTINGS']> div[id='IS_RESET_BTN']").size()&&(d.IS_RESET=$(a).find("itemBody > div[id='SETTINGS'] > div[id='IS_RESET_BTN']").text(),d.IS_RESET="true"==d.IS_RESET?!0:!1),$(a).find("itemBody > div[id='SETTINGS']> div[id='IS_SHOWME']").size()&&(d.IS_SHOWME=$(a).find("itemBody > div[id='SETTINGS'] > div[id='IS_SHOWME']").text(),d.IS_SHOWME="true"==d.IS_SHOWME?!0:!1),$(a).find("itemBody > div[id='SETTINGS']> div[id='IS_ATTEMPT_AGAIN']").size()?(d.IS_ATTEMPT_AGAIN=$(a).find("itemBody > div[id='SETTINGS'] > div[id='IS_ATTEMPT_AGAIN']").text(),d.IS_ATTEMPT_AGAIN="true"==d.IS_ATTEMPT_AGAIN?!0:!1):$(a).find("itemBody > div[id='SETTINGS']> div[id='IS_RESET']").size()&&(d.IS_ATTEMPT_AGAIN=$(a).find("itemBody > div[id='SETTINGS']> div[id='IS_RESET']").text(),d.IS_ATTEMPT_AGAIN="true"==d.IS_ATTEMPT_AGAIN?!0:!1),d.is_settings=$(a).find('itemBody > div[id="SETTINGS"]').size()?!0:!1,d};var MAX_TRIES_PER_CARD,correctTry="",numberOfTries=0,isAssessmentItemScoreDirty=!1,assessmentItemScore=-1,isInAssessmentMode=!0,dataObject=null,mode="",className="instructionMCSS",previewTabIndexStart=100,tabIndex=100;$(document).ready(function(){if(mode=$.query.get("mode"),mode==PreviewModes.DEVELOPER_MODE){var a="../../content/MCPageGroup/page/"+$.query.get("id")+".xml",b="../../content/MCPageGroup/page/AssetRef.xml",c="../../config/config.xml";loadPageData(a,b,c)}else if(mode==PreviewModes.AUTHOR_PREVIEW_MODE){var d=$.query.get("pageId"),e=$.query.get("ver_no")?$.query.get("ver_no"):"0",f="0"==$.query.get("curr_ver")||"1"==$.query.get("curr_ver")?$.query.get("curr_ver"):"1",g=$.query.get("diId")?$.query.get("diId"):"0",h=$.query.get("verId")?$.query.get("verId"):"0",i=$.query.get("folder_name")?$.query.get("folder_name"):"0",a="/CAPS/AssetUploadServlet?contentType=topic&pageId="+d+"&ver_no="+e+"&curr_ver="+f+"&diId="+g+"&verId="+h+"&folder_name="+i+"&randID="+Math.floor(1e3*Math.random()),b="/CAPS/AssetUploadServlet?contentType=assetReference&pageId="+d+"&ver_no="+e+"&curr_ver="+f+"&diId="+g+"&verId="+h+"&folder_name="+i+"&randID="+Math.floor(1e3*Math.random()),c="../../config/config.xml";loadPageData(a,b,c)}else mode==PreviewModes.SEARCH_PREVIEW_MODE?authorPreviewData():mode==PreviewModes.PLAYER_PREVIEW_MODE?($("#pageContainer").css("overflow","auto"),postMsgListener(MultipleChoiceAdapter,populateContent)):parsePostData(MultipleChoiceAdapter,populateContent);$("#mclose").click(function(){$(".indImg").css("display","none"),$.modal.close(),$("input[name='options']").removeAttr("checked"),$("#btnSubmit").button("disable"),disableButton("#btnSubmit")}),$(document).bind("feedback",provideFeedback)});